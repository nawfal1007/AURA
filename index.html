<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>AURA APPAREL | Sustainable Indonesian Luxury Flagship</title>
    <meta name="description" content="Official digital flagship of Aura Apparel. Sustainable fashion handcrafted in Java.">
    <meta name="author" content="Titan Systems">
    <link rel="icon" type="image/png" href="https://fav.farm/ðŸŒ¿">

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/intersect@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        window.tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        aura: {
                            /* Brand Core: Inspired by Indonesian Silk & Obsidian */
                            base: '#FBFBF9',       /* Silk Pearl */
                            dark: '#0A1A17',       /* Deep Volcanic Obsidian */
                            accent: '#D4AF37',     /* Liquid Gold Leaf */
                            
                            /* Glassmorphism Layers */
                            glass: 'rgba(255, 255, 255, 0.05)',
                            'glass-border': 'rgba(255, 255, 255, 0.22)',
                            'glass-dark': 'rgba(10, 26, 23, 0.72)',
                            
                            /* Semantic/System Colors */
                            error: '#9B2C2C',      /* Crimson Alert */
                            success: '#2F855A',    /* Forest Growth */
                            sand: '#E6E2DD'        /* Neutral Accents */
                        }
                    },
                    fontFamily: {
                        sans: ['Lato', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    spacing: {
                        '18': '4.5rem',
                        '22': '5.5rem',
                        '128': '32rem',
                    },
                    animation: {
                        /* High-End Motion Physics */
                        'blob-slow': 'blob 22s infinite alternate ease-in-out',
                        'blob-fast': 'blob 15s infinite alternate-reverse ease-in-out',
                        'glass-slide': 'glassSlide 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'float-y': 'floatY 8s ease-in-out infinite',
                        'shimmer-infinite': 'shimmer 2.5s linear infinite',
                        'fade-in-quick': 'fadeIn 0.4s ease-out forwards',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1) rotate(0deg)' },
                            '33%': { transform: 'translate(30px, -40px) scale(1.1) rotate(15deg)' },
                            '66%': { transform: 'translate(-40px, 20px) scale(0.9) rotate(-15deg)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1) rotate(0deg)' },
                        },
                        glassSlide: {
                            '0%': { opacity: '0', transform: 'translateY(40px) scale(0.96)', filter: 'blur(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0) scale(1)', filter: 'blur(0)' }
                        },
                        floatY: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-200% 0' },
                            '100%': { backgroundPosition: '200% 0' }
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* 1. Global Reset & Performance Layer */
        [x-cloak] { display: none !important; }
        
        body, html { 
            overflow-x: hidden; 
            width: 100%;
            position: relative;
            background-color: #FBFBF9;
            -webkit-font-smoothing: antialiased;
        }

        /* 2. THE LIQUID GLASS SYSTEM (Refraction Engine) */
        .liquid-glass {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.22);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.04);
            transition: all 0.7s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .liquid-glass-dark {
            background: rgba(10, 26, 23, 0.75);
            backdrop-filter: blur(35px) saturate(140%);
            -webkit-backdrop-filter: blur(35px) saturate(140%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.25);
        }

        /* 3. BIOLOGICAL BACKGROUND PHYSICS (Liquid Blobs) */
        .canvas-blob {
            position: absolute;
            width: 350px; height: 350px; /* Small default for mobile */
            filter: blur(80px);
            border-radius: 50%;
            z-index: -1;
            opacity: 0.35;
            pointer-events: none;
            mix-blend-mode: multiply;
        }

        @media (min-width: 768px) {
            .canvas-blob { 
                width: 900px; 
                height: 900px; 
                filter: blur(140px); 
            }
        }

        /* 4. SCROLLBAR ARCHITECTURE */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { 
            background: #0A1A17; 
            border-radius: 20px; 
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* 5. TYPOGRAPHY & INTERACTION UTILITIES */
        .tracking-titan { letter-spacing: 0.6em; }
        .text-glow-accent { text-shadow: 0 0 25px rgba(212, 175, 55, 0.4); }
        .vertical-text { writing-mode: vertical-rl; }

        .btn-refract {
            position: relative;
            overflow: hidden;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .btn-refract::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.8s;
        }
        .btn-refract:hover::before { left: 100%; }

        /* Navigation Scrolled State */
        .nav-scrolled {
            background: rgba(251, 251, 249, 0.85) !important;
            backdrop-filter: blur(20px) saturate(160%);
            padding-top: 1rem !important;
            padding-bottom: 1rem !important;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.05);
        }

        /* No-Scrollbar Utility (For Mobile Horizontal Swiping) */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>

<body class="selection:bg-aura-dark selection:text-aura-accent" x-data="auraTitan()">

    <div class="fixed inset-0 z-[-1] overflow-hidden bg-aura-base">
        <div class="canvas-blob bg-blue-100 top-[-10%] left-[-10%] animate-blob-slow"></div>
        <div class="canvas-blob bg-aura-accent/20 bottom-[-10%] right-[-10%] animate-blob-fast" style="animation-delay: 2s;"></div>
        <div class="canvas-blob bg-pink-100 top-[35%] left-[20%] animate-blob-slow" style="animation-delay: 4s;"></div>
    </div>


    <div class="fixed top-10 right-6 z-[300] flex flex-col gap-4 pointer-events-none">
        <template x-for="toast in toasts" :key="toast.id">
            <div x-show="toast.visible" 
                 x-transition:enter="transition ease-out duration-600 transform"
                 x-transition:enter-start="opacity-0 translate-x-20 scale-90"
                 x-transition:enter-end="opacity-100 translate-x-0 scale-100"
                 x-transition:leave="transition ease-in duration-400 opacity-0 translate-x-10"
                 class="liquid-glass-dark text-white px-8 py-5 rounded-3xl flex items-center gap-5 min-w-[320px] shadow-2xl pointer-events-auto border-l-4 border-aura-accent">
                
                <div class="w-12 h-12 rounded-full flex items-center justify-center bg-white/10 border border-white/10">
                    <i class="ph-fill ph-sparkle text-aura-accent text-2xl animate-pulse"></i>
                </div>

                <div class="flex-1">
                    <h4 class="text-[9px] font-bold uppercase tracking-titan text-aura-accent mb-0.5" x-text="toast.title"></h4>
                    <p class="text-xs font-light text-white/70" x-text="toast.message"></p>
                </div>

                <button @click="removeToast(toast.id)" class="text-white/20 hover:text-white transition-colors">
                    <i class="ph ph-x-circle text-xl"></i>
                </button>
            </div>
        </template>
    </div>


    <header class="fixed top-0 w-full z-[100] transition-all duration-1000 ease-[cubic-bezier(0.16,1,0.3,1)] px-4 md:px-8 py-8 md:py-14"
            :class="scrolled && 'nav-scrolled'">
        
        <div class="max-w-7xl mx-auto">
            <div class="liquid-glass rounded-full px-6 md:px-12 py-4 md:py-6 flex justify-between items-center transition-all duration-1000"
                 :class="scrolled ? 'shadow-2xl translate-y-0 border-white/30' : 'border-transparent bg-transparent backdrop-blur-none shadow-none'">
                
                <div class="flex items-center gap-4 md:gap-10 w-1/4">
                    <button @click="mobileMenuOpen = true" 
                            class="p-2 hover:text-aura-accent transition-all duration-500 transform hover:scale-110 active:scale-90">
                        <i class="ph ph-list text-3xl md:text-4xl"></i>
                    </button>
                    
                    <template x-if="isAdmin">
                        <a href="admin.html" class="hidden lg:flex items-center gap-4 bg-aura-dark text-white px-8 py-3 rounded-full text-[10px] font-bold uppercase tracking-[0.25em] shadow-xl hover:bg-aura-accent hover:text-aura-dark transition-all duration-700 btn-refract group">
                            <i class="ph-fill ph-shield-star text-aura-accent group-hover:text-aura-dark transition-colors"></i>
                            Admin Vault
                        </a>
                    </template>
                    
                    <div x-show="!isAdmin" class="hidden xl:block">
                        <span class="text-[9px] uppercase tracking-[0.6em] text-aura-dark/20 font-bold">Artisan Heritage</span>
                    </div>
                </div>

                <div class="flex-1 text-center">
                    <a href="#" class="inline-block relative group">
                        <h1 class="text-xl md:text-4xl font-serif font-bold tracking-[0.4em] uppercase transition-all duration-1000 group-hover:tracking-[0.55em]">
                            AURA<span class="text-aura-accent">.</span>
                        </h1>
                        <div class="absolute -inset-4 bg-aura-accent/5 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-1000 -z-10"></div>
                    </a>
                </div>

                <div class="w-1/4 flex justify-end items-center gap-6 md:gap-12">
                    <nav class="hidden lg:flex gap-12 text-[10px] font-bold tracking-[0.3em] uppercase text-gray-400">
                        <a href="#shop" class="hover:text-aura-dark transition-colors duration-500 relative group">
                            Catalog
                            <span class="absolute -bottom-2 left-0 w-0 h-0.5 bg-aura-dark transition-all duration-500 group-hover:w-full"></span>
                        </a>
                        <template x-if="session">
                            <a href="profile.html" class="text-aura-dark hover:text-aura-accent transition-colors">My Dossier</a>
                        </template>
                    </nav>

                    <div class="flex items-center gap-4 md:gap-10 border-l border-gray-200 pl-6 md:pl-12">
                        <template x-if="!session">
                            <a href="loginpage.html" class="hover:text-aura-accent transition-all duration-500 transform hover:scale-110 active:scale-90" title="Access Account">
                                <i class="ph ph-user-focus text-3xl md:text-4xl"></i>
                            </a>
                        </template>
                        <template x-if="session">
                            <button @click="handleLogout" class="hover:text-aura-error transition-all duration-500 transform hover:rotate-90" title="Secure Exit">
                                <i class="ph ph-sign-out text-3xl md:text-4xl"></i>
                            </button>
                        </template>

                        <button @click="cartOpen = true" class="relative group active:scale-90 transition-transform duration-300">
                            <i class="ph ph-tote text-3xl md:text-4xl group-hover:text-aura-accent transition-colors duration-500"></i>
                            <span x-show="cartCount > 0" 
                                  x-cloak
                                  class="absolute -top-1 -right-1 bg-aura-dark text-aura-accent text-[9px] w-6 h-6 md:w-7 md:h-7 rounded-full flex items-center justify-center font-bold shadow-2xl border-2 border-white animate-bounce" 
                                  x-text="cartCount"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    ```
<section class="relative min-h-[95vh] md:min-h-screen flex items-center justify-center pt-28 md:pt-40 pb-20 overflow-hidden px-4 md:px-12">
        <div class="container mx-auto relative z-10 grid grid-cols-1 lg:grid-cols-12 gap-12 md:gap-24 items-center">
            
            <div class="lg:col-span-5 z-20 text-center lg:text-left order-2 lg:order-1" 
                 x-intersect="$el.classList.add('animate-glass-slide')">
                
                <div class="inline-flex items-center gap-4 bg-aura-dark text-aura-accent px-8 md:px-10 py-3 md:py-4 rounded-full mb-10 shadow-2xl border border-white/10 group overflow-hidden relative">
                    <div class="absolute inset-0 bg-white/10 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 pointer-events-none"></div>
                    <span class="relative flex h-3 w-3">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-aura-accent opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-3 w-3 bg-aura-accent"></span>
                    </span>
                    <span class="text-[10px] md:text-[11px] font-bold uppercase tracking-[0.5em] md:tracking-[0.6em] relative z-10">Loom Series â€¢ 2026</span>
                </div>

                <h2 class="text-5xl md:text-8xl lg:text-[10rem] font-serif font-medium leading-[0.85] md:leading-[0.8] mb-10 md:mb-14 text-aura-dark tracking-tighter">
                    Liquid <br>
                    <span class="italic text-gray-300 text-glow-accent">Essence.</span>
                </h2>

                <p class="max-w-md mx-auto lg:mx-0 text-gray-500 font-light text-base md:text-xl leading-relaxed mb-12 md:mb-16 border-l-0 lg:border-l-4 border-aura-accent/30 pl-0 lg:pl-10">
                    Discover a digital flagship where sustainable Javanese silk flows like mercury. Handcrafted artifacts designed for the conscious modern soul.
                </p>

                <div class="flex flex-col sm:flex-row gap-6 md:gap-8 justify-center lg:justify-start pt-4">
                    <a href="#shop" class="bg-aura-dark text-white px-14 md:px-20 py-5 md:py-7 rounded-full text-[10px] md:text-[11px] font-bold uppercase tracking-[0.4em] md:tracking-[0.5em] shadow-2xl hover:bg-aura-accent hover:text-aura-dark transition-all duration-700 transform hover:-translate-y-2 btn-refract text-center">
                        Archive Access
                    </a>
                    <button @click="scrollToAbout" class="glass-refracted text-aura-dark px-10 md:px-16 py-5 md:py-7 rounded-full text-[10px] md:text-[11px] font-bold uppercase tracking-[0.4em] md:tracking-[0.5em] hover:bg-white transition-all duration-700 shadow-lg">
                        The Narrative
                    </button>
                </div>
            </div>

            <div class="lg:col-span-7 relative group order-1 lg:order-2">
                <div class="relative w-full aspect-[4/5] glass-refracted p-4 md:p-8 rounded-[3.5rem] md:rounded-[4.5rem] shadow-2xl animate-float-y transition-all duration-1000 group-hover:scale-[1.02]">
                    <div class="w-full h-full rounded-[2.8rem] md:rounded-[3.8rem] overflow-hidden relative shadow-inner bg-aura-sand">
                        <img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?q=80&w=2000" 
                             alt="Luxury Aura Silk Apparel" 
                             class="w-full h-full object-cover transition-transform duration-[4s] group-hover:scale-110 brightness-95 group-hover:brightness-100">
                        
                        <div class="absolute inset-0 bg-gradient-to-tr from-aura-dark/20 via-transparent to-white/20 mix-blend-overlay pointer-events-none"></div>
                    </div>

                    <div class="absolute -top-12 -right-8 glass-dark-refracted p-8 md:p-12 rounded-3xl shadow-2xl animate-float-y hidden md:block" style="animation-delay: 1.5s;">
                        <div class="flex items-center gap-6 text-white">
                            <div class="w-14 h-14 rounded-full bg-aura-accent flex items-center justify-center text-aura-dark">
                                <i class="ph-fill ph-leaf text-3xl"></i>
                            </div>
                            <div>
                                <p class="text-2xl font-serif font-bold text-aura-accent leading-none mb-1">100%</p>
                                <p class="text-[9px] uppercase tracking-[0.4em] opacity-40">Bio-Organic</p>
                            </div>
                        </div>
                    </div>

                    <div class="absolute -bottom-8 -left-6 md:-bottom-12 md:-left-16 glass-refracted p-8 md:p-12 rounded-[2rem] md:rounded-[3rem] shadow-2xl animate-float-y" style="animation-delay: 3.5s;">
                        <p class="text-3xl md:text-6xl font-serif font-bold text-aura-dark mb-1 md:mb-2 text-glow-accent italic">Java</p>
                        <p class="text-[9px] md:text-[11px] text-gray-400 font-bold uppercase tracking-[0.4em] md:tracking-[0.5em]">Central Source</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="absolute bottom-12 left-10 flex flex-col items-center gap-12 opacity-30 hidden xl:flex">
            <span class="vertical-text uppercase text-[10px] font-bold tracking-[1em] text-aura-dark">System Protocol â€¢ Identity</span>
            <div class="w-px h-40 bg-gradient-to-b from-aura-dark to-transparent animate-pulse"></div>
        </div>
    </section>

    <section class="py-32 md:py-56 bg-white border-y border-aura-dark/5 relative overflow-hidden">
        <div class="absolute top-0 right-0 w-96 h-96 bg-aura-accent/5 rounded-full blur-[100px] -z-10"></div>
        
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row items-center gap-20 md:gap-32">
                
                <div class="w-full md:w-1/2 grid grid-cols-2 gap-8 md:gap-16 order-2 md:order-1" x-intersect="$el.classList.add('animate-glass-slide')">
                    <div class="space-y-4 md:space-y-6 group">
                        <div class="w-16 h-16 glass-refracted rounded-2xl flex items-center justify-center group-hover:bg-aura-dark group-hover:text-white transition-all duration-700">
                            <i class="ph ph-waves text-3xl"></i>
                        </div>
                        <h4 class="text-4xl md:text-5xl font-serif text-aura-dark">12k</h4>
                        <p class="text-[9px] md:text-[10px] uppercase tracking-[0.4em] text-gray-400 font-bold leading-relaxed">Liters of Water <br>Recovered (2026)</p>
                    </div>
                    <div class="space-y-4 md:space-y-6 group">
                        <div class="w-16 h-16 glass-refracted rounded-2xl flex items-center justify-center group-hover:bg-aura-dark group-hover:text-white transition-all duration-700">
                            <i class="ph ph-tree text-3xl"></i>
                        </div>
                        <h4 class="text-4xl md:text-5xl font-serif text-aura-dark">0%</h4>
                        <p class="text-[9px] md:text-[10px] uppercase tracking-[0.4em] text-gray-400 font-bold leading-relaxed">Deforestation <br>Supply Path</p>
                    </div>
                    <div class="space-y-4 md:space-y-6 group">
                        <div class="w-16 h-16 glass-refracted rounded-2xl flex items-center justify-center group-hover:bg-aura-dark group-hover:text-white transition-all duration-700">
                            <i class="ph ph-users text-3xl"></i>
                        </div>
                        <h4 class="text-4xl md:text-5xl font-serif text-aura-dark">65+</h4>
                        <p class="text-[9px] md:text-[10px] uppercase tracking-[0.4em] text-gray-400 font-bold leading-relaxed">Collaborative <br>Artisan Families</p>
                    </div>
                    <div class="space-y-4 md:space-y-6 group">
                        <div class="w-16 h-16 glass-refracted rounded-2xl flex items-center justify-center group-hover:bg-aura-dark group-hover:text-white transition-all duration-700">
                            <i class="ph ph-heartbeat text-3xl"></i>
                        </div>
                        <h4 class="text-4xl md:text-5xl font-serif text-aura-dark">Life</h4>
                        <p class="text-[9px] md:text-[10px] uppercase tracking-[0.4em] text-gray-400 font-bold leading-relaxed">Warranty on <br>Every Thread</p>
                    </div>
                </div>

                <div class="w-full md:w-1/2 order-1 md:order-2" x-intersect="$el.classList.add('animate-glass-slide')">
                    <span class="text-aura-accent font-bold uppercase tracking-[0.6em] text-[10px] md:text-[11px] block mb-8">Systemic Integrity</span>
                    <h3 class="text-4xl md:text-7xl font-serif text-aura-dark leading-[0.9] mb-12">Fashion as a <br><span class="italic text-gray-300">Force for Good.</span></h3>
                    <div class="space-y-8 text-gray-500 font-light text-base md:text-xl leading-relaxed">
                        <p>We do not produce fashion; we steward an ecosystem. Aura pieces are designed with a circular philosophyâ€”where every fiber can return to the earth.</p>
                        <p>Our workshop in Yogyakarta operates on a 100% solar grid, blending seven generations of weaving knowledge with modern regenerative technology.</p>
                    </div>
                    <div class="pt-12">
                        <button class="inline-flex items-center gap-6 group">
                            <span class="text-aura-accent font-bold uppercase tracking-[0.5em] text-[10px] group-hover:text-aura-dark transition-colors duration-500">View Transparency Dossier</span>
                            <div class="w-14 h-14 rounded-full glass-refracted flex items-center justify-center group-hover:bg-aura-accent group-hover:text-white transition-all duration-700 group-hover:scale-110">
                                <i class="ph ph-arrow-right text-2xl"></i>
                            </div>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </section>


    <main id="shop" class="relative py-32 md:py-60 bg-transparent">
        <div class="container mx-auto px-6">
            
            <div class="flex flex-col md:flex-row justify-between items-center md:items-end mb-24 md:mb-32 border-b border-aura-dark/5 pb-16 md:pb-24 relative">
                <div class="max-w-2xl text-center md:text-left mb-16 md:mb-0" x-intersect="$el.classList.add('animate-glass-slide')">
                    <span class="text-aura-accent font-bold uppercase tracking-[0.6em] text-[10px] md:text-[11px] block mb-6">Archive Access</span>
                    <h2 class="text-5xl md:text-9xl font-serif text-aura-dark leading-[0.85] mb-8">The Collection<span class="text-gray-200">.</span></h2>
                    <p class="text-gray-400 font-light text-base md:text-xl leading-relaxed max-w-lg">
                        Meticulously curated artifacts. Sustainable perfection generated on-demand to eliminate inventory waste.
                    </p>
                </div>
                
                <div class="w-full md:w-auto overflow-x-auto no-scrollbar pb-4 md:pb-0">
                    <div class="inline-flex glass-refracted p-2.5 md:p-3 rounded-full gap-2 md:gap-4 shadow-2xl transition-all duration-700 hover:scale-[1.01]">
                        <template x-for="cat in ['All', 'Tops', 'Bottoms', 'Dresses', 'Accessories']">
                            <button @click="activeCategory = cat" 
                                    :class="activeCategory === cat ? 'bg-aura-dark text-white shadow-2xl scale-105' : 'hover:bg-aura-base text-gray-400 hover:text-aura-dark'"
                                    class="px-8 md:px-14 py-4 md:py-5 rounded-full text-[9px] md:text-[11px] font-bold uppercase tracking-[0.3em] md:tracking-[0.4em] transition-all duration-700 ease-out whitespace-nowrap"
                                    x-text="cat"></button>
                    </template>
                    </div>
                </div>
            </div>

            <div x-show="productsLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 md:gap-16">
                <template x-for="i in 4">
                    <div class="glass-refracted p-5 md:p-6 rounded-[2.5rem] md:rounded-[3.5rem] space-y-10 animate-pulse">
                        <div class="aspect-[3/4] rounded-[2rem] md:rounded-[2.8rem] bg-gray-100/50"></div>
                        <div class="space-y-4 px-4 pb-4">
                            <div class="h-8 bg-gray-100/50 w-3/4 rounded-lg"></div>
                            <div class="h-5 bg-gray-100/50 w-1/4 rounded-lg"></div>
                        </div>
                    </div>
                </template>
            </div>

            <div x-show="!productsLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-12 gap-y-24 md:gap-y-32" x-cloak>
                <template x-for="product in filteredProducts" :key="product.id">
                    <div class="group flex flex-col h-full animate-glass-slide">
                        
                        <div class="glass-refracted p-4 md:p-6 rounded-[3rem] md:rounded-[3.5rem] transition-all duration-1000 group-hover:shadow-[0_40px_80px_rgba(0,0,0,0.08)] group-hover:-translate-y-8 relative overflow-hidden">
                            
                            <div class="relative aspect-[3/4] overflow-hidden rounded-[2.2rem] md:rounded-[2.5rem] bg-aura-base mb-10 shadow-inner cursor-pointer">
                                <img :src="product.image" 
                                     class="w-full h-full object-cover transition-transform duration-[3s] ease-out group-hover:scale-110 group-hover:rotate-1">
                                
                                <div class="absolute top-6 left-6 md:top-8 md:left-8 flex flex-col gap-3 md:gap-4 z-10 pointer-events-none">
                                    <span x-show="product.badge" class="glass-dark-refracted text-aura-accent text-[9px] font-bold uppercase tracking-[0.4em] px-5 py-2 md:px-7 md:py-3 rounded-full border border-white/10 shadow-2xl" x-text="product.badge"></span>
                                    <span x-show="product.is_new" class="bg-white/95 text-aura-dark text-[9px] font-bold uppercase tracking-[0.4em] px-5 py-2 md:px-7 md:py-3 rounded-full shadow-2xl">Limited Run</span>
                                </div>

                                <div class="absolute inset-x-0 bottom-0 p-8 md:p-12 translate-y-full group-hover:translate-y-0 transition-transform duration-[0.7s] ease-[cubic-bezier(0.16,1,0.3,1)] glass-dark-refracted border-t border-white/5">
                                    <p class="text-[9px] uppercase font-bold text-aura-accent mb-6 md:mb-8 text-center tracking-[0.5em] opacity-50">Select Size</p>
                                    <div class="flex justify-center gap-4 md:gap-6">
                                        <template x-for="size in ['S', 'M', 'L']">
                                            <button @click="addToCart(product, size)" 
                                                    class="w-14 h-14 md:w-16 md:h-16 rounded-full border border-aura-accent/30 text-aura-accent hover:bg-aura-accent hover:text-aura-dark transition-all duration-700 text-[11px] md:text-[12px] font-bold shadow-2xl active:scale-90">
                                                <span x-text="size"></span>
                                            </button>
                                        </template>
                                    </div>
                                    <p class="text-[8px] md:text-[9px] text-white/20 text-center mt-8 md:mt-10 uppercase tracking-[0.4em]">Encrypted Dispatch Ready</p>
                                </div>
                            </div>

                            <div class="flex justify-between items-start px-4 md:px-6 pb-4 md:pb-6">
                                <div class="space-y-2 md:space-y-4">
                                    <h3 class="font-serif text-2xl md:text-3xl text-aura-dark group-hover:text-aura-accent transition-colors duration-700 cursor-pointer" x-text="product.name"></h3>
                                    <p class="text-[10px] md:text-[11px] text-gray-400 uppercase tracking-[0.5em] font-bold" x-text="product.category"></p>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold text-xl md:text-2xl font-serif text-aura-dark group-hover:scale-110 transition-transform duration-700 origin-right" x-text="formatMoney(product.price)"></p>
                                    <div class="flex items-center gap-2 justify-end mt-4 text-aura-success opacity-80">
                                        <i class="ph-fill ph-check-circle text-lg"></i>
                                        <span class="text-[8px] md:text-[9px] font-bold uppercase tracking-widest">In Stock</span>
                                    </div>
                                </div>
                            </div>

                            <template x-if="isAdmin">
                                <a href="admin.html" class="absolute top-6 right-6 md:top-8 md:right-8 w-12 h-12 md:w-14 md:h-14 bg-aura-dark text-aura-accent rounded-full flex items-center justify-center shadow-2xl border border-white/20 opacity-0 group-hover:opacity-100 transition-all duration-500 scale-50 group-hover:scale-100 hover:bg-aura-accent hover:text-aura-dark">
                                    <i class="ph-bold ph-pencil-simple text-xl md:text-2xl"></i>
                                </a>
                            </template>
                        </div>
                    </div>
                </template>
            </div>

            <div class="mt-40 md:mt-60 text-center" x-intersect="$el.classList.add('animate-glass-slide')">
                <div class="relative inline-block group">
                    <div class="absolute inset-0 bg-aura-accent/15 rounded-full blur-[80px] opacity-0 group-hover:opacity-100 transition-opacity duration-1000 -z-10"></div>
                    
                    <button @click="toggleArchive()" 
                            class="relative z-10 glass-refracted text-aura-dark px-16 md:px-24 py-6 md:py-10 rounded-full text-[11px] md:text-[13px] font-bold uppercase tracking-[0.4em] md:tracking-[0.6em] hover:bg-aura-dark hover:text-white transition-all duration-1000 shadow-2xl flex items-center gap-6 md:gap-10 group active:scale-95">
                        
                        <span x-text="archiveExpanded ? 'Collapse Archive' : 'View Entire Collection'"></span>
                        
                        <div class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-aura-dark group-hover:bg-aura-accent flex items-center justify-center transition-all duration-700">
                            <i class="ph-bold text-white group-hover:text-aura-dark text-xl md:text-2xl transition-transform duration-700"
                               :class="archiveExpanded ? 'ph-caret-up rotate-180' : 'ph-arrow-right'"></i>
                        </div>
                    </button>
                </div>
                
                <p class="mt-12 text-[9px] md:text-[10px] uppercase tracking-[0.8em] text-gray-300 font-bold" x-show="!archiveExpanded">
                    + <span x-text="products.length - 8"></span> Artifacts in Vault
                </p>
            </div>

        </div>
    </main>
    <div class="relative z-[300]" x-show="cartOpen" x-cloak>
        <div class="fixed inset-0 bg-aura-dark/70 backdrop-blur-2xl transition-opacity duration-1000" 
             x-show="cartOpen" @click="cartOpen = false"
             x-transition:enter="ease-out duration-700" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
             x-transition:leave="ease-in duration-500" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>

        <div class="fixed inset-y-0 right-0 w-full md:max-w-xl flex flex-col transform transition-all duration-1000 ease-[cubic-bezier(0.16,1,0.3,1)]"
             x-show="cartOpen" x-transition:enter="translate-x-full" x-transition:enter-end="translate-x-0"
             x-transition:leave="translate-x-0" x-transition:leave-end="translate-x-full">
            
            <div class="h-full flex flex-col liquid-glass-dark shadow-2xl overflow-hidden relative border-l border-white/5">
                
                <div class="p-8 md:p-12 flex justify-between items-center border-b border-white/5 bg-white/5">
                    <div>
                        <h3 class="text-2xl md:text-3xl font-serif font-bold text-white tracking-[0.3em] uppercase">The Selection</h3>
                        <p class="text-[9px] md:text-[10px] uppercase tracking-[0.5em] text-aura-accent font-bold mt-3" 
                           x-text="cartCount + ' Preserved Artifacts'"></p>
                    </div>
                    <button @click="cartOpen = false" class="text-white/20 hover:text-aura-error transition-all duration-700 group active:scale-90">
                        <i class="ph ph-x-circle text-4xl md:text-5xl transform group-hover:rotate-180"></i>
                    </button>
                </div>

                <div class="flex-1 overflow-y-auto p-8 md:p-12 custom-scroll space-y-12 relative">
                    <div x-show="cartLoading" class="absolute inset-0 bg-aura-dark/60 z-20 flex items-center justify-center backdrop-blur-md">
                        <div class="w-16 h-16 border-4 border-aura-accent border-t-transparent rounded-full animate-spin"></div>
                    </div>

                    <div x-show="cart.length === 0" class="text-center py-40 animate-glass-slide">
                        <div class="w-24 h-24 md:w-32 md:h-32 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-10 border border-white/5">
                            <i class="ph ph-tote text-6xl md:text-7xl text-white/10"></i>
                        </div>
                        <p class="font-serif italic text-xl md:text-2xl text-white/30 tracking-widest">Bag is currently void.</p>
                        <button @click="cartOpen = false" class="mt-8 text-[10px] font-bold uppercase tracking-[0.4em] text-aura-accent border-b border-aura-accent/20 pb-1 hover:text-white transition-all">Resume Exploration</button>
                    </div>
                    
                    <ul class="space-y-12 md:space-y-16">
                        <template x-for="(item, index) in cart" :key="index">
                            <li class="flex gap-6 md:gap-10 group animate-glass-slide">
                                <div class="w-24 h-32 md:w-32 md:h-44 rounded-3xl overflow-hidden border border-white/10 flex-shrink-0 shadow-2xl transition-all duration-700 group-hover:scale-105 group-hover:rotate-1">
                                    <img :src="item.image" class="w-full h-full object-cover">
                                </div>
                                <div class="flex-1 flex flex-col justify-between py-1 md:py-2">
                                    <div>
                                        <div class="flex justify-between items-start">
                                            <h4 x-text="item.name" class="font-serif font-bold text-white text-xl md:text-2xl pr-4"></h4>
                                            <p x-text="formatMoney(item.price * item.quantity)" class="text-sm md:text-lg font-bold text-aura-accent"></p>
                                        </div>
                                        <div class="flex items-center gap-4 md:gap-6 mt-4 md:mt-6">
                                            <p class="text-[9px] md:text-[10px] text-white/40 font-bold uppercase tracking-[0.4em]">Size <span x-text="item.size" class="text-white ml-2 md:ml-3 bg-white/10 px-3 py-1 rounded-full"></span></p>
                                            <p class="text-[9px] md:text-[10px] text-white/40 font-bold uppercase tracking-[0.4em]">Qty <span x-text="item.quantity" class="text-white ml-2 md:ml-3 bg-white/10 px-3 py-1 rounded-full"></span></p>
                                        </div>
                                    </div>
                                    <button @click="removeFromCart(index, item)" 
                                            class="text-aura-error/60 text-[9px] md:text-[10px] font-bold uppercase tracking-[0.4em] hover:text-aura-error transition-all text-left underline underline-offset-8">Void Selection</button>
                                </div>
                            </li>
                        </template>
                    </ul>
                </div>

                <div class="p-8 md:p-12 bg-white/5 border-t border-white/5 shadow-[0_-30px_60px_rgba(0,0,0,0.3)]">
                    <div class="flex justify-between items-end mb-10 md:mb-12">
                        <div class="space-y-2 md:space-y-3">
                            <p class="text-[10px] md:text-[11px] font-bold uppercase text-white/30 tracking-[0.5em] md:tracking-[0.6em]">Estimated Settlement</p>
                            <h4 class="text-4xl md:text-5xl font-serif font-bold text-white text-glow-accent" x-text="formatMoney(cartTotal)"></h4>
                        </div>
                        <div class="text-right">
                            <p class="text-[10px] md:text-[11px] font-bold text-aura-success uppercase tracking-[0.3em]">Direct Logistics Inc.</p>
                        </div>
                    </div>
                    
                    <a href="checkout.html" class="block w-full bg-aura-accent text-aura-dark py-6 md:py-8 rounded-[1.5rem] md:rounded-[2rem] text-center text-[10px] md:text-xs font-bold uppercase tracking-[0.5em] md:tracking-[0.6em] hover:bg-white transition-all duration-1000 shadow-2xl active:scale-[0.97] btn-refract">
                        Authorize Payment
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div x-show="mobileMenuOpen" class="fixed inset-0 z-[250] lg:hidden" x-cloak>
        <div class="absolute inset-0 bg-aura-dark/80 backdrop-blur-2xl transition-opacity" @click="mobileMenuOpen = false"></div>
        
        <div class="relative w-[85%] h-full liquid-glass-dark p-10 md:p-14 flex flex-col transform transition-transform duration-700"
             x-transition:enter="translate-x-[-100%]" x-transition:enter-end="translate-x-0"
             x-transition:leave="translate-x-0" x-transition:leave-end="translate-x-[-100%]">
            
            <div class="flex justify-between items-center mb-20 md:mb-24">
                <span class="text-2xl font-serif font-bold tracking-[0.4em] text-white">AURA.</span>
                <button @click="mobileMenuOpen = false" class="text-white/40 active:scale-90"><i class="ph ph-x text-4xl"></i></button>
            </div>

            <nav class="flex-1 flex flex-col gap-10 md:gap-12 text-4xl md:text-5xl font-serif text-white/50">
                <a href="#shop" @click="mobileMenuOpen = false" class="block hover:text-aura-accent transition-all duration-500">The Archive</a>
                <a href="catalog.html" class="block hover:text-aura-accent transition-all duration-500">Catalog 2.0</a>
                
                <div x-show="session" class="space-y-10 md:space-y-12 border-t border-white/5 pt-10 md:pt-12">
                    <a href="profile.html" class="block text-aura-accent italic">My Dossier</a>
                    <template x-if="isAdmin">
                        <a href="admin.html" class="block text-sm font-sans font-bold uppercase tracking-[0.4em] bg-aura-accent text-aura-dark p-6 rounded-2xl text-center shadow-2xl">Master Console</a>
                    </template>
                </div>
            </nav>

            <div class="mt-auto pt-10 border-t border-white/5">
                <template x-if="!session">
                    <a href="loginpage.html" class="block w-full bg-white text-aura-dark py-5 rounded-2xl text-center text-xs font-bold uppercase tracking-[0.4em] shadow-xl">Identify</a>
                </template>
                <div x-show="session" class="flex flex-col gap-6">
                    <p class="text-[9px] uppercase tracking-[0.5em] text-white/20 text-center" x-text="'Signed in as ' + session.user.email"></p>
                    <button @click="logout" class="block w-full border border-aura-error/30 text-aura-error py-5 rounded-2xl text-center text-[10px] font-bold uppercase tracking-[0.4em] hover:bg-aura-error hover:text-white transition-all duration-700">Terminate</button>
                </div>
            </div>
        </div>
    </div>


    <footer class="bg-white pt-40 md:pt-60 pb-16 md:pb-24 relative overflow-hidden border-t border-aura-dark/5">
        <div class="absolute bottom-0 right-0 w-128 h-128 bg-aura-accent/10 rounded-full blur-[160px] -z-10"></div>
        
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 lg:grid-cols-6 gap-20 md:gap-32 mb-32 md:mb-40">
                
                <div class="lg:col-span-2 space-y-12 md:space-y-16">
                    <div>
                        <a href="#" class="text-4xl md:text-5xl font-serif font-bold tracking-[0.4em] uppercase text-aura-dark block mb-10 transition-all hover:tracking-[0.5em]">AURA<span class="text-aura-accent">.</span></a>
                        <p class="text-gray-400 text-base md:text-lg leading-relaxed max-w-sm font-light">
                            Synthesizing a sustainable future through the intersection of Indonesian heritage and high-performance digital logic. Every thread is a signature.
                        </p>
                    </div>
                    
                    <div class="flex gap-8 md:gap-10">
                        <template x-for="icon in ['instagram-logo', 'tiktok-logo', 'pinterest-logo']">
                            <a href="#" class="w-14 h-14 md:w-16 md:h-16 rounded-full glass-refracted flex items-center justify-center hover:bg-aura-dark hover:text-white transition-all duration-1000 transform hover:-translate-y-3">
                                <i :class="'ph-fill ph-' + icon" class="text-2xl md:text-3xl"></i>
                            </a>
                        </template>
                    </div>
                </div>

                <div class="space-y-10 md:space-y-12">
                    <h5 class="text-[10px] md:text-[11px] font-bold uppercase tracking-[0.6em] text-aura-accent">Discovery</h5>
                    <ul class="space-y-6 md:space-y-8 text-xs md:text-sm text-gray-400 font-bold tracking-[0.3em] uppercase">
                        <li><a href="#shop" class="hover:text-aura-dark transition-all duration-500">Current Archive</a></li>
                        <li><a href="catalog.html" class="hover:text-aura-dark transition-all duration-500">Global Catalog</a></li>
                        <li><a href="#" class="hover:text-aura-dark transition-all duration-500">Gift Protocol</a></li>
                    </ul>
                </div>

                <div class="space-y-10 md:space-y-12">
                    <h5 class="text-[10px] md:text-[11px] font-bold uppercase tracking-[0.6em] text-aura-accent">The Firm</h5>
                    <ul class="space-y-6 md:space-y-8 text-xs md:text-sm text-gray-400 font-bold tracking-[0.3em] uppercase">
                        <li><a href="#story" class="hover:text-aura-dark transition-all duration-500">Artisan Legacy</a></li>
                        <li><a href="#" class="hover:text-aura-dark transition-all duration-500">Impact Dossier</a></li>
                        <li><a href="#" class="hover:text-aura-dark transition-all duration-500">Transparency</a></li>
                    </ul>
                </div>

                <div class="lg:col-span-2 space-y-10 md:space-y-12">
                    <h5 class="text-[10px] md:text-[11px] font-bold uppercase tracking-[0.6em] text-aura-accent">Intake Portal</h5>
                    <p class="text-xs md:text-sm text-gray-400 leading-relaxed font-light uppercase tracking-widest">Subscribe to receive technical bulletins on new drops and heritage preservation reports.</p>
                    <div class="relative group">
                        <input type="email" placeholder="IDENTITY@EMAIL.COM" 
                               class="bg-transparent border-b-2 border-gray-100 py-6 w-full text-xs outline-none focus:border-aura-dark transition-all duration-1000 font-bold tracking-[0.4em]">
                        <button class="absolute right-0 top-1/2 -translate-y-1/2 text-aura-accent hover:text-aura-dark transition-all duration-500 font-bold uppercase text-[10px] tracking-[0.4em]">Authorize</button>
                    </div>
                </div>
            </div>

            <div class="pt-16 md:pt-20 border-t border-gray-100 flex flex-col lg:flex-row justify-between items-center text-[10px] uppercase tracking-[0.6em] text-gray-300 gap-10 md:gap-12">
                <div class="flex flex-col md:flex-row gap-8 md:gap-16 items-center">
                    <p>&copy; 2026 Aura Apparel Global Systems.</p>
                    <div class="hidden md:block h-5 w-px bg-gray-200"></div>
                    <p>Designed and Handcrafted in Java, Indonesia.</p>
                </div>
                <div class="flex gap-10 md:gap-14">
                    <a href="#" class="hover:text-aura-dark transition-all">Privacy Protocol</a>
                    <a href="#" class="hover:text-aura-dark transition-all">Terms of Use</a>
                </div>
            </div>
        </div>
    </footer>


    <script>
        function auraTitan() {
            return {
                /* --- I. SYSTEM INFRASTRUCTURE --- */
                supabase: null,
                session: null,
                isAdmin: false,
                
                scrolled: false,
                mobileMenuOpen: false,
                cartOpen: false,
                cartLoading: false,
                productsLoading: true,
                archiveExpanded: false,
                
                /* --- II. DATA MANIFEST --- */
                products: [],
                activeCategory: 'All',
                cart: [],
                toasts: [],

                /* --- III. COMPUTED INTELLIGENCE --- */
                /** Returns total fiscal value of items in bag */
                get cartTotal() { 
                    return this.cart.reduce((total, item) => total + (item.price * item.quantity), 0); 
                },
                /** Returns total unit count of artifacts */
                get cartCount() { 
                    return this.cart.reduce((total, item) => total + item.quantity, 0); 
                },
                /** Reactive inventory filtering based on category and expansion state */
                get filteredProducts() {
                    let base = this.activeCategory === 'All' 
                        ? this.products 
                        : this.products.filter(p => p.category === this.activeCategory);
                    
                    return this.archiveExpanded ? base : base.slice(0, 8);
                },

                /* --- IV. BOOT SEQUENCE --- */
                /** Main initialization on page ready */
                init() {
                    // Optimized Scroll Management
                    window.addEventListener('scroll', () => { 
                        this.scrolled = window.scrollY > 80; 
                    });
                    
                    this.establishSecureConnection();
                },

                /** Establishes cloud connection and triggers data hydration */
                async establishSecureConnection() {
                    const SB_URL = 'https://xenosyklkpisszqwibdw.supabase.co';
                    const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhlbm9zeWtsa3Bpc3N6cXdpYmR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA4NTkxNzcsImV4cCI6MjA4NjQzNTE3N30.A_WVC9GRa7USe2DPbzVUWw3TuBHnyImVqBZnzuPJbMw';
                    
                    this.supabase = supabase.createClient(SB_URL, SB_KEY);
                    
                    // Concurrent loading for performance optimization
                    await Promise.all([
                        this.syncGlobalInventory(),
                        this.initializeSecurityContext()
                    ]);
                },

                /* --- V. DATABASE & SECURITY ARCHITECTURE --- */
                /** Fetches latest artifacts from the secure Supabase cluster */
                async syncGlobalInventory() {
                    this.productsLoading = true;
                    try {
                        const { data, error } = await this.supabase
                            .from('products')
                            .select('*')
                            .order('created_at', { ascending: false });
                        
                        if (error) throw error;
                        this.products = data || [];
                    } catch (err) {
                        console.error('Titan Inventory Error:', err);
                        this.showToast('System Error', 'Database synchronization failed.', 'error');
                    } finally {
                        this.productsLoading = false;
                    }
                },

                /** Establishes session listeners for real-time auth changes */
                async initializeSecurityContext() {
                    const { data: { session } } = await this.supabase.auth.getSession();
                    this.processIdentityGateway(session);
                    
                    this.supabase.auth.onAuthStateChange((_, s) => {
                        this.processIdentityGateway(s);
                    });
                },

                /** Routes state based on user identity and privileges */
                async processIdentityGateway(session) {
                    this.session = session;
                    // Strict Admin Verification Logic
                    this.isAdmin = session && session.user.email === 'dashwebtr3@gmail.com';
                    
                    if (session) {
                        await this.mergeLocalToCloud();
                        await this.fetchCloudManifest();
                    } else {
                        this.loadLocalArchive();
                    }
                },

                /* --- VI. COMMERCE TRANSACTION ENGINE --- */
                /** Universal entry point for adding items to Bag */
                async addToCart(product, size) {
                    this.cartOpen = true;
                    if (!this.session) {
                        this.processGuestAddition(product, size);
                    } else {
                        await this.processCloudAddition(product, size);
                    }
                },

                /** Logic for unauthenticated users (Local Storage) */
                processGuestAddition(product, size) {
                    const exists = this.cart.find(i => i.id === product.id && i.size === size);
                    if (exists) {
                        exists.quantity++;
                    } else {
                        this.cart.push({...JSON.parse(JSON.stringify(product)), size, quantity: 1});
                    }
                    this.persistLocalArchive();
                    this.showToast('Selection Preserved', `${product.name} added to guest bag.`);
                },

                /** Logic for authenticated users (Supabase Sync) */
                async processCloudAddition(product, size) {
                    this.cartLoading = true;
                    try {
                        const exists = this.cart.find(i => i.id === product.id && i.size === size);
                        const qty = exists ? exists.quantity + 1 : 1;

                        const { error } = await this.supabase
                            .from('cart_items')
                            .upsert({
                                user_id: this.session.user.id,
                                product_id: product.id,
                                size: size,
                                quantity: qty
                            }, { onConflict: 'user_id, product_id, size' });

                        if (error) throw error;
                        await this.fetchCloudManifest();
                        this.showToast('Cloud Sync Success', `${product.name} saved to secure profile.`);
                    } catch (e) {
                        this.showToast('Sync Failure', 'Database write rejected.', 'error');
                    } finally {
                        this.cartLoading = false;
                    }
                },

                /** Hydrates local state from database keys */
                async fetchCloudManifest() {
                    const { data, error } = await this.supabase.from('cart_items').select('*');
                    if (error) return;

                    this.cart = data.map(dbItem => {
                        const meta = this.products.find(p => p.id === dbItem.product_id);
                        return meta ? {...meta, size: dbItem.size, quantity: dbItem.quantity} : null;
                    }).filter(Boolean);
                },

                /** Transfers local bag items to cloud database after login */
                async mergeLocalToCloud() {
                    const data = JSON.parse(localStorage.getItem('aura_titan_v6') || '[]');
                    if (data.length > 0) {
                        this.showToast('Archive Integration', 'Merging guest selections...');
                        for(const item of data) await this.processCloudAddition(item, item.size);
                        localStorage.removeItem('aura_titan_v6');
                    }
                },

                /** Removes item and updates corresponding storage engine */
                async removeFromCart(idx, item) {
                    this.cartLoading = true;
                    if(!this.session) {
                        this.cart.splice(idx, 1);
                        this.persistLocalArchive();
                    } else {
                        await this.supabase.from('cart_items').delete().match({
                            user_id: this.session.user.id, product_id: item.id, size: item.size
                        });
                        this.cart.splice(idx, 1);
                    }
                    this.cartLoading = false;
                },

                /* --- VII. SYSTEM UTILITIES --- */
                persistLocalArchive() { localStorage.setItem('aura_titan_v6', JSON.stringify(this.cart)); },
                loadLocalArchive() { this.cart = JSON.parse(localStorage.getItem('aura_titan_v6') || '[]'); },
                
                toggleArchive() { 
                    this.archiveExpanded = !this.archiveExpanded; 
                    if(!this.archiveExpanded) document.getElementById('shop').scrollIntoView({ behavior: 'smooth' }); 
                },

                async logout() { 
                    await this.supabase.auth.signOut(); 
                    this.cart = []; 
                    this.isAdmin = false;
                    this.showToast('Session Terminated', 'Security protocols active.');
                },
                
                formatMoney(v) { 
                    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumSignificantDigits: 9 }).format(v); 
                },

                showToast(title, message) {
                    const id = Date.now();
                    this.toasts.push({ id, title, message, visible: true });
                    setTimeout(() => {
                        const t = this.toasts.find(x => x.id === id);
                        if(t) t.visible = false;
                        setTimeout(() => { this.toasts = this.toasts.filter(x => x.id !== id); }, 600);
                    }, 4000);
                },

                removeToast(id) {
                    this.toasts = this.toasts.filter(x => x.id !== id);
                },

                scrollToAbout() {
                    const el = document.getElementById('story');
                    if(el) el.scrollIntoView({ behavior: 'smooth' });
                }
            }
        }
    </script>
</body>
</html>
